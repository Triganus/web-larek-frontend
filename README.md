# Веб-ларёк

Интернет-магазин веб-разработчика с товарами для программистов. Проект реализован на TypeScript по архитектурному паттерну MVP с событийным взаимодействием. Пользователь может просматривать каталог товаров, добавлять их в корзину и оформлять заказ в два этапа.

## 1. Используемый стек

| Цель                    | Технология                           |
|-------------------------|--------------------------------------|
| Язык / типизация        | TypeScript 5                        |
| Сборка                  | Webpack 5, ts-loader, sass-loader   |
| Стили                   | SCSS + PostCSS (autoprefixer)       |
| UI                      | HTML 5, семантические теги, CSS Grid|
| Линтинг                 | ESLint, Prettier                    |

Дополнительные пакеты перечислены в `package.json`.

## 2. Быстрый старт

Клонируйте репозиторий и установите зависимости:

```bash
npm install
```

или

```bash
yarn
```

Создайте файл окружения `.env` в корне проекта с содержимым:

```env
API_ORIGIN=https://larek-api.nomoreparties.co
```

Запустите режим разработки с hot-reload:

```bash
npm run start
```

Соберите production-версию:

```bash
npm run build
```

### Полезные скрипты

- `npm run lint` — проверка ESLint
- `npm run lint:fix` — авто-исправление
- `npm run format` — форматирование Prettier

## 3. Архитектура проекта

Проект разбит на три логических слоя: **Модели (Model)**, **Представления (View)** и **Презентер (Presenter)**. Связь между слоями осуществляется через общий EventEmitter — брокер событий, что обеспечивает слабое связывание и упрощает тестирование.

```
┌─────────┐   пользовательское действие   ┌──────────────┐   изменение данных   ┌────────────┐
│  View   │ ────────────────────────────▶ │  Presenter   │ ──────────────────▶ │   Model    │
└─────────┘ ◀──────────────────────────── └──────────────┘ ◀────────────────── └────────────┘
             render/update                        load / mutate
```

### 3.1 Базовые классы

| Класс         | Расположение                        | Назначение                                                                   |
|---------------|-------------------------------------|------------------------------------------------------------------------------|
| EventEmitter  | src/components/base/events.ts       | Управляет подпиской и рассылкой событий между слоями приложения.             |
| Model<T>      | src/components/base/Model.ts        | Абстрактная модель-обёртка поверх данных типа T. Предоставляет emitChanges.  |
| Component<P>  | src/components/base/component.ts    | Базовый класс представления: хранит ссылку на DOM, управляет элементами.     |
| Api           | src/components/base/api.ts          | Инкапсулирует HTTP-запросы (fetch). Методы для GET/POST запросов.            |

### 3.2 Планируемые модели данных

| Модель        | Интерфейс       | Назначение                                                         |
|---------------|-----------------|-------------------------------------------------------------------|
| CatalogModel  | ICatalogModel   | Управление списком товаров и выбранным товаром для предпросмотра  |
| BasketModel   | IBasketModel    | Управление содержимым корзины, подсчет суммы и количества         |
| OrderModel    | IOrderModel     | Хранение данных заказа, валидация форм, создание объекта заказа   |

### 3.3 Планируемые представления

| Компонент     | Интерфейс     | Назначение                                               |
|---------------|---------------|----------------------------------------------------------|
| Card          | ICardView     | Карточка товара с информацией и кнопками действий        |
| Basket        | IBasketView   | Список товаров в корзине с итоговой суммой              |
| Modal         | IModalView    | Универсальное модальное окно                             |
| Form          | IFormView     | Базовая логика форм с валидацией                         |
| OrderForm     | IOrderForm    | Форма выбора способа оплаты и ввода адреса               |
| ContactsForm  | IContactsForm | Форма ввода контактной информации                        |
| Success       | ISuccessView  | Страница успешного оформления заказа                     |
| Page          | IPageView     | Главная страница с каталогом и счетчиком корзины         |

## 4. Типы данных

Все типы объявлены в `src/types/` и разделены по файлам:

- `api.ts` — типы для API запросов и ответов
- `events.ts` — типы событийной системы и перечисления событий  
- `product.ts` — типы для товаров и каталога
- `basket.ts` — типы для корзины покупок
- `order.ts` — типы для заказов и форм
- `views.ts` — типы для представлений и компонентов
- `index.ts` — общий экспорт всех типов

### Ключевые интерфейсы

```typescript
// Товар из API
interface IProduct {
  id: string;
  title: string;
  description: string;
  price: number | null;
  image: string;
  category: ProductCategory;
}

// Данные заказа
interface IOrder {
  payment?: PaymentMethod;
  email?: string;
  phone?: string;
  address?: string;
  items: string[];
  total: number;
}

// Интерфейсы моделей
interface ICatalogModel {
  products: IProduct[];
  getProducts(): Promise<IProduct[]>;
  getProduct(id: string): IProduct | undefined;
  setProducts(products: ApiProduct[]): void;
}

interface IBasketModel {
  items: Map<string, IBasketItem>;
  add(product: IProduct): void;
  remove(id: string): void;
  clear(): void;
  getTotal(): number;
}

// События приложения
enum AppEvent {
  ProductSelected = 'product:selected',
  BasketChanged = 'basket:changed',
  OrderSubmitted = 'order:submitted',
  ModalOpened = 'modal:opened'
}
```

## 5. Процессы приложения

Основные пользовательские сценарии:

1. **Просмотр каталога** — загрузка товаров через API, отображение в виде карточек
2. **Выбор товара** — просмотр детальной информации в модальном окне
3. **Управление корзиной** — добавление/удаление товаров, подсчет стоимости
4. **Оформление заказа** — двухэтапная форма с валидацией данных
5. **Завершение покупки** — отправка заказа на сервер, показ результата

Все взаимодействия реализуются через событийную систему без прямых связей между компонентами.

## 6. Структура проекта

```
src/
├── components/               # компоненты приложения
│   └── base/                # базовые абстракции (EventEmitter, Component, Model, Api)
├── types/                   # TypeScript типы и интерфейсы
│   ├── api.ts              # типы API
│   ├── events.ts           # события
│   ├── product.ts          # товары
│   ├── basket.ts           # корзина
│   ├── order.ts            # заказы
│   ├── views.ts            # представления
│   └── index.ts            # экспорт
├── utils/                   # утилиты и константы
├── scss/                    # стили
└── index.ts                 # точка входа
```

## Заключение

На данном этапе спроектирована архитектура приложения и определены все необходимые типы данных. Базовые абстракции готовы для последующей реализации моделей и представлений. Событийная система обеспечит слабую связанность компонентов и упростит расширение функциональности.



